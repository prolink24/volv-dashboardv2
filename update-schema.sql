-- Add new columns to activities table
ALTER TABLE activities ADD COLUMN IF NOT EXISTS call_duration INTEGER;
ALTER TABLE activities ADD COLUMN IF NOT EXISTS call_direction TEXT;
ALTER TABLE activities ADD COLUMN IF NOT EXISTS call_outcome TEXT;
ALTER TABLE activities ADD COLUMN IF NOT EXISTS call_notes TEXT;
ALTER TABLE activities ADD COLUMN IF NOT EXISTS call_recording_url TEXT;
ALTER TABLE activities ADD COLUMN IF NOT EXISTS email_subject TEXT;
ALTER TABLE activities ADD COLUMN IF NOT EXISTS email_body TEXT;
ALTER TABLE activities ADD COLUMN IF NOT EXISTS email_status TEXT;
ALTER TABLE activities ADD COLUMN IF NOT EXISTS email_template TEXT;
ALTER TABLE activities ADD COLUMN IF NOT EXISTS task_status TEXT;
ALTER TABLE activities ADD COLUMN IF NOT EXISTS task_due_date TIMESTAMP;
ALTER TABLE activities ADD COLUMN IF NOT EXISTS task_assigned_to TEXT;
ALTER TABLE activities ADD COLUMN IF NOT EXISTS task_priority TEXT;
ALTER TABLE activities ADD COLUMN IF NOT EXISTS field_coverage INTEGER;

-- Add new columns to deals table
ALTER TABLE deals ADD COLUMN IF NOT EXISTS cash_collected TEXT;
ALTER TABLE deals ADD COLUMN IF NOT EXISTS contracted_value TEXT;
ALTER TABLE deals ADD COLUMN IF NOT EXISTS value_period TEXT;
ALTER TABLE deals ADD COLUMN IF NOT EXISTS value_currency TEXT;
ALTER TABLE deals ADD COLUMN IF NOT EXISTS confidence INTEGER;
ALTER TABLE deals ADD COLUMN IF NOT EXISTS lead_name TEXT;
ALTER TABLE deals ADD COLUMN IF NOT EXISTS status_label TEXT;
ALTER TABLE deals ADD COLUMN IF NOT EXISTS field_coverage INTEGER;

-- Add new columns to contacts table
ALTER TABLE contacts ADD COLUMN IF NOT EXISTS sources_count INTEGER;
ALTER TABLE contacts ADD COLUMN IF NOT EXISTS first_touch_date TIMESTAMP;
ALTER TABLE contacts ADD COLUMN IF NOT EXISTS assignment_date TIMESTAMP;
ALTER TABLE contacts ADD COLUMN IF NOT EXISTS preferred_contact_method TEXT;
ALTER TABLE contacts ADD COLUMN IF NOT EXISTS timezone TEXT;
ALTER TABLE contacts ADD COLUMN IF NOT EXISTS language TEXT;
ALTER TABLE contacts ADD COLUMN IF NOT EXISTS lead_score INTEGER;
ALTER TABLE contacts ADD COLUMN IF NOT EXISTS qualification_status TEXT;
ALTER TABLE contacts ADD COLUMN IF NOT EXISTS lead_temperature TEXT;
ALTER TABLE contacts ADD COLUMN IF NOT EXISTS linkedin_url TEXT;
ALTER TABLE contacts ADD COLUMN IF NOT EXISTS twitter_handle TEXT;
ALTER TABLE contacts ADD COLUMN IF NOT EXISTS secondary_email TEXT;
ALTER TABLE contacts ADD COLUMN IF NOT EXISTS secondary_phone TEXT;
ALTER TABLE contacts ADD COLUMN IF NOT EXISTS utm_source TEXT;
ALTER TABLE contacts ADD COLUMN IF NOT EXISTS utm_medium TEXT;
ALTER TABLE contacts ADD COLUMN IF NOT EXISTS utm_campaign TEXT;
ALTER TABLE contacts ADD COLUMN IF NOT EXISTS referral_source TEXT;
ALTER TABLE contacts ADD COLUMN IF NOT EXISTS tags TEXT[];
ALTER TABLE contacts ADD COLUMN IF NOT EXISTS field_coverage INTEGER;
ALTER TABLE contacts ADD COLUMN IF NOT EXISTS required_fields_complete BOOLEAN DEFAULT FALSE;

-- Add new columns to meetings table
ALTER TABLE meetings ADD COLUMN IF NOT EXISTS duration INTEGER;
ALTER TABLE meetings ADD COLUMN IF NOT EXISTS assignee_email TEXT;
ALTER TABLE meetings ADD COLUMN IF NOT EXISTS assignee_timezone TEXT;
ALTER TABLE meetings ADD COLUMN IF NOT EXISTS invitee_email TEXT;
ALTER TABLE meetings ADD COLUMN IF NOT EXISTS invitee_name TEXT;
ALTER TABLE meetings ADD COLUMN IF NOT EXISTS invitee_timezone TEXT;
ALTER TABLE meetings ADD COLUMN IF NOT EXISTS location TEXT;
ALTER TABLE meetings ADD COLUMN IF NOT EXISTS conference_url TEXT;
ALTER TABLE meetings ADD COLUMN IF NOT EXISTS conference_data JSONB;
ALTER TABLE meetings ADD COLUMN IF NOT EXISTS rescheduled BOOLEAN DEFAULT FALSE;
ALTER TABLE meetings ADD COLUMN IF NOT EXISTS canceled_at TIMESTAMP;
ALTER TABLE meetings ADD COLUMN IF NOT EXISTS cancel_reason TEXT;
ALTER TABLE meetings ADD COLUMN IF NOT EXISTS calendar_event JSONB;
ALTER TABLE meetings ADD COLUMN IF NOT EXISTS questions JSONB;
ALTER TABLE meetings ADD COLUMN IF NOT EXISTS answers JSONB;
ALTER TABLE meetings ADD COLUMN IF NOT EXISTS utm_source TEXT;
ALTER TABLE meetings ADD COLUMN IF NOT EXISTS utm_medium TEXT;
ALTER TABLE meetings ADD COLUMN IF NOT EXISTS utm_campaign TEXT;
ALTER TABLE meetings ADD COLUMN IF NOT EXISTS utm_content TEXT;
ALTER TABLE meetings ADD COLUMN IF NOT EXISTS utm_term TEXT;
ALTER TABLE meetings ADD COLUMN IF NOT EXISTS field_coverage INTEGER;

-- Add new columns to forms table
ALTER TABLE forms ADD COLUMN IF NOT EXISTS form_id TEXT;
ALTER TABLE forms ADD COLUMN IF NOT EXISTS respondent_email TEXT;
ALTER TABLE forms ADD COLUMN IF NOT EXISTS respondent_name TEXT;
ALTER TABLE forms ADD COLUMN IF NOT EXISTS respondent_ip TEXT;
ALTER TABLE forms ADD COLUMN IF NOT EXISTS completion_time INTEGER;
ALTER TABLE forms ADD COLUMN IF NOT EXISTS completion_percentage INTEGER;
ALTER TABLE forms ADD COLUMN IF NOT EXISTS last_page_seen INTEGER;
ALTER TABLE forms ADD COLUMN IF NOT EXISTS form_score INTEGER;
ALTER TABLE forms ADD COLUMN IF NOT EXISTS form_category TEXT;
ALTER TABLE forms ADD COLUMN IF NOT EXISTS form_tags TEXT[];
ALTER TABLE forms ADD COLUMN IF NOT EXISTS question_count INTEGER;
ALTER TABLE forms ADD COLUMN IF NOT EXISTS answered_count INTEGER;
ALTER TABLE forms ADD COLUMN IF NOT EXISTS hidden_fields JSONB;
ALTER TABLE forms ADD COLUMN IF NOT EXISTS calculated_fields JSONB;
ALTER TABLE forms ADD COLUMN IF NOT EXISTS utm_source TEXT;
ALTER TABLE forms ADD COLUMN IF NOT EXISTS utm_medium TEXT;
ALTER TABLE forms ADD COLUMN IF NOT EXISTS utm_campaign TEXT;
ALTER TABLE forms ADD COLUMN IF NOT EXISTS utm_term TEXT;
ALTER TABLE forms ADD COLUMN IF NOT EXISTS utm_content TEXT;
ALTER TABLE forms ADD COLUMN IF NOT EXISTS field_coverage INTEGER;
ALTER TABLE forms ADD COLUMN IF NOT EXISTS metadata JSONB;

-- Add new columns to metrics table
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS date_range TEXT;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS lead_source TEXT;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS won_deals INTEGER DEFAULT 0;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS lost_deals INTEGER DEFAULT 0;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS open_deals INTEGER DEFAULT 0;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS contracted_value TEXT DEFAULT '0';
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS calls_to_close NUMERIC DEFAULT 0;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS calls_answered INTEGER DEFAULT 0;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS calls_unanswered INTEGER DEFAULT 0;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS total_meetings INTEGER DEFAULT 0;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS meetings_attended INTEGER DEFAULT 0;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS meetings_canceled INTEGER DEFAULT 0;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS meetings_rescheduled INTEGER DEFAULT 0;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS total_forms INTEGER DEFAULT 0;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS forms_completed INTEGER DEFAULT 0;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS form_conversion_rate NUMERIC DEFAULT 0;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS avg_deal_size TEXT DEFAULT '0';
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS sales_cycle_days INTEGER DEFAULT 0;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS attribution_accuracy INTEGER DEFAULT 0;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS multi_source_rate NUMERIC DEFAULT 0;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS field_coverage INTEGER DEFAULT 0;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS contacts_with_multiple_sources INTEGER DEFAULT 0;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS new_leads INTEGER DEFAULT 0;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS qualified_leads INTEGER DEFAULT 0;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS disqualified_leads INTEGER DEFAULT 0;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS lead_qualification_time INTEGER DEFAULT 0;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS lead_conversion_rate NUMERIC DEFAULT 0;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS cost_per_lead NUMERIC DEFAULT 0;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS cost_per_closed_won NUMERIC DEFAULT 0;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS source_distribution JSONB;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS channel_efficiency JSONB;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS admins_missing INTEGER DEFAULT 0;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS slot_utilization NUMERIC DEFAULT 0;
ALTER TABLE metrics ADD COLUMN IF NOT EXISTS kpis JSONB;